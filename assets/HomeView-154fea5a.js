import{r as a,o as r,c as d,w as m,a as c,b as I,d as b,F as w,e as y,f as g,n as L,p as R,g as H,h as Z}from"./index-f8df8a71.js";const $={name:"Start",emits:["transformend"],props:{config:Object,highlight:Boolean},data(){return{}},methods:{sendEvent(e){this.$emit("transformend",e)}}},p=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n};function J(e,t){const n=a("v-circle");return e.highlight?(r(),d(n,{key:1,config:{...e.config,shadowBlur:50,shadowColor:"yellow",stroke:"yellow"},onTransformend:e.sendEvent},null,8,["config","onTransformend"])):(r(),d(n,{key:0,config:e.config,onTransformend:e.sendEvent},null,8,["config","onTransformend"]))}const z=p($,[["render",J]]),q={name:"End",emits:["transformend"],props:{config:Object,highlight:Boolean},data(){return{}},methods:{sendEvent(e){this.$emit("transformend",e)}}};function K(e,t){const n=a("v-circle");return e.highlight?(r(),d(n,{key:1,config:{...e.config,shadowBlur:50,shadowColor:"yellow",stroke:"yellow"},onTransformend:e.sendEvent},null,8,["config","onTransformend"])):(r(),d(n,{key:0,config:e.config,onTransformend:e.sendEvent},null,8,["config","onTransformend"]))}const B=p(q,[["render",K]]),Q={name:"Decision",emits:["transformend","transformstart","editProcess"],props:{config:Object,highlight:Boolean},data(){return{configRect:{x:100,y:50,width:100,height:100,fill:"white",stroke:"black",rotation:45},image:null}},created(){const e=new window.Image;e.src="/img/edit.svg",e.onload=()=>{this.image=e}},watch:{},methods:{sendEvent(e){this.$emit("transformend",e)},sendEvent2(e){this.$emit("transformstart",e)},editProcess(e){this.$emit("editProcess",this.config.name)}}};function U(e,t,n,i,o,s){const l=a("v-rect"),f=a("v-text"),u=a("v-image"),v=a("v-label");return r(),d(v,{config:{x:n.config.x,y:n.config.y,draggable:n.config.draggable}},{default:m(()=>[n.highlight?(r(),d(l,{key:1,config:{rotation:n.config.rotation,name:n.config.name,x:0,y:-(Math.sqrt(n.config.height**2+n.config.width**2)/2),width:n.config.width,height:n.config.height,fill:n.config.fill,stroke:n.config.stroke,draggable:!1,scaleX:n.config.scaleX,scaleY:n.config.scaleY,strokeScaleEnabled:!1,shadowBlur:50,shadowColor:"yellow",stroke:"yellow"},onTransformend:s.sendEvent,onTransformstart:s.sendEvent2},null,8,["config","onTransformend","onTransformstart"])):(r(),d(l,{key:0,config:{name:n.config.name,x:0,y:-(Math.sqrt(n.config.height**2+n.config.width**2)/2),width:n.config.width,height:n.config.height,fill:n.config.fill,stroke:n.config.stroke,draggable:!1,scaleX:n.config.scaleX,scaleY:n.config.scaleY,strokeScaleEnabled:!1,rotation:n.config.rotation},onTransformend:s.sendEvent,onTransformstart:s.sendEvent2},null,8,["config","onTransformend","onTransformstart"])),c(f,{config:{x:-n.config.width/2,y:-n.config.height/4,width:n.config.width,text:n.config.text,fontFamily:"Calibri",fontSize:18,padding:5,fill:"black",draggable:!1,align:"center",listening:!1}},null,8,["config"]),c(v,{config:{x:n.config.width/2,y:-n.config.height/2,draggable:!1}},{default:m(()=>[c(u,{config:{image:o.image,visible:!n.config.hideEdit,draggable:!1},onMouseup:s.editProcess},null,8,["config","onMouseup"])]),_:1},8,["config"]),I("> ")]),_:1},8,["config"])}const M=p(Q,[["render",U]]),ee={name:"Declaration",emits:["transformend","transformstart","editProcess"],props:{config:Object,highlight:Boolean},data(){return{image:null}},created(){const e=new window.Image;e.src="/img/edit.svg",e.onload=()=>{this.image=e}},watch:{},methods:{sendEvent(e){this.$emit("transformend",e)},sendEvent2(e){this.$emit("transformstart",e)},editProcess(e){this.$emit("editProcess",this.config.name)}}};function ne(e,t){const n=a("v-rect"),i=a("v-text"),o=a("v-image"),s=a("v-label");return r(),d(s,{config:{x:e.config.x,y:e.config.y,draggable:e.config.draggable}},{default:m(()=>[e.highlight?(r(),d(n,{key:1,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1,shadowBlur:50,shadowColor:"yellow",stroke:"yellow"},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])):(r(),d(n,{key:0,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])),c(i,{config:{x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,text:e.config.text,fontFamily:"Calibri",fontSize:18,padding:5,fill:"black",draggable:!1,align:"left",listening:!1}},null,8,["config"]),c(s,{config:{x:e.config.width/2-24,y:-e.config.height/2}},{default:m(()=>[c(o,{config:{image:e.image,visible:!e.config.hideEdit},onMouseup:e.editProcess},null,8,["config","onMouseup"])]),_:1},8,["config"])]),_:1},8,["config"])}const O=p(ee,[["render",ne]]),te={name:"Process",emits:["transformend","transformstart","editProcess"],props:{config:Object,highlight:Boolean},data(){return{image:null}},created(){const e=new window.Image;e.src="/img/edit.svg",e.onload=()=>{this.image=e}},watch:{},methods:{sendEvent(e){this.$emit("transformend",e)},sendEvent2(e){this.$emit("transformstart",e)},editProcess(e){this.$emit("editProcess",this.config.name)}}};function ie(e,t){const n=a("v-rect"),i=a("v-text"),o=a("v-image"),s=a("v-label");return r(),d(s,{config:{x:e.config.x,y:e.config.y,draggable:e.config.draggable}},{default:m(()=>[e.highlight?(r(),d(n,{key:1,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1,shadowBlur:50,shadowColor:"yellow",stroke:"yellow"},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])):(r(),d(n,{key:0,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])),c(i,{config:{x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,text:e.config.text,fontFamily:"Calibri",fontSize:18,padding:5,fill:"black",draggable:!1,align:"left",listening:!1}},null,8,["config"]),c(s,{config:{x:e.config.width/2-24,y:-e.config.height/2}},{default:m(()=>[c(o,{config:{image:e.image,visible:!e.config.hideEdit},onMouseup:e.editProcess},null,8,["config","onMouseup"])]),_:1},8,["config"])]),_:1},8,["config"])}const A=p(te,[["render",ie]]),se={name:"Pprint",emits:["transformend","transformstart","editProcess"],props:{config:Object,highlight:Boolean},data(){return{image:null}},created(){const e=new window.Image;e.src="/img/edit.svg",e.onload=()=>{this.image=e}},watch:{},methods:{sendEvent(e){this.$emit("transformend",e)},sendEvent2(e){this.$emit("transformstart",e)},editProcess(e){this.$emit("editProcess",this.config.name)}}};function oe(e,t){const n=a("v-shape"),i=a("v-text"),o=a("v-image"),s=a("v-label");return r(),d(s,{config:{x:e.config.x,y:e.config.y,draggable:e.config.draggable}},{default:m(()=>[e.highlight?(r(),d(n,{key:1,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1,shadowBlur:50,shadowColor:"yellow",stroke:"yellow",sceneFunc:function(l,f){l.beginPath(),l.moveTo(0,0),l.lineTo(e.config.width,0),l.lineTo(e.config.width,3*e.config.height/4),l.lineTo(e.config.width/3,3*e.config.height/4),l.quadraticCurveTo(e.config.width/6,e.config.height*1.2,0,3*e.config.height/4),l.closePath(),l.fillStrokeShape(f)}},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])):(r(),d(n,{key:0,config:{name:e.config.name,x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,height:e.config.height,fill:e.config.fill,stroke:e.config.stroke,draggable:!1,scaleX:e.config.scaleX,scaleY:e.config.scaleY,strokeScaleEnabled:!1,sceneFunc:function(l,f){l.beginPath(),l.moveTo(0,0),l.lineTo(e.config.width,0),l.lineTo(e.config.width,3*e.config.height/4),l.lineTo(e.config.width/3,3*e.config.height/4),l.quadraticCurveTo(e.config.width/6,e.config.height*1.2,0,3*e.config.height/4),l.closePath(),l.fillStrokeShape(f)}},onTransformend:e.sendEvent,onTransformstart:e.sendEvent2},null,8,["config","onTransformend","onTransformstart"])),c(i,{config:{x:-e.config.width/2,y:-e.config.height/2,width:e.config.width,text:e.config.text,fontFamily:"Calibri",fontSize:18,padding:5,fill:"black",draggable:!1,align:"left",listening:!1}},null,8,["config"]),c(s,{config:{x:e.config.width/2-24,y:-e.config.height/2}},{default:m(()=>[c(o,{config:{image:e.image,visible:!e.config.hideEdit},onMouseup:e.editProcess},null,8,["config","onMouseup"])]),_:1},8,["config"])]),_:1},8,["config"])}const N=p(se,[["render",oe]]),ae={name:"StartButton",props:{position:Object},components:{Start:z},data(){return{}}};function re(e,t){const n=a("Start"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{x:30,y:30,radius:20,fill:"white",stroke:"black",strokeWidth:4}}),c(i,{config:{x:0,y:55,text:"Inicio",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:60}}),c(o,{config:{name:"Pstart",x:0,y:0,width:60,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const le=p(ae,[["render",re]]),ce={name:"StartButton",props:{position:Object},components:{End:B},data(){return{}}};function de(e,t){const n=a("End"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{x:30,y:30,radius:20,fill:"grey",stroke:"black",strokeWidth:4}}),c(i,{config:{x:0,y:55,text:"Fin",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:60}}),c(o,{config:{name:"Pend",x:0,y:0,width:60,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const he=p(ce,[["render",de]]),ge={name:"ProcessButton",props:{position:Object},components:{Process:A},data(){return{}}};function fe(e,t){const n=a("Process"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{name:"Pprocess",x:20+80/2,y:10+40/2,width:80,height:40,fill:"white",stroke:"black",draggable:!0,text:"",scaleX:1,scaleY:1,hideEdit:!0}}),c(i,{config:{x:0,y:55,text:"Proceso",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:120}}),c(o,{config:{name:"Pprocess",x:0,y:0,width:120,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const ue=p(ge,[["render",fe]]),me={name:"DeclarationButton",props:{position:Object},components:{Declaration:O},data(){return{}}};function pe(e,t){const n=a("Declaration"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{name:"Pdeclaration",x:20+80/2,y:10+40/2,width:80,height:40,fill:"white",stroke:"black",draggable:!0,text:"",scaleX:1,scaleY:1,hideEdit:!0}}),c(i,{config:{x:0,y:55,text:"Declaración",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:120}}),c(o,{config:{name:"Pdeclaration",x:0,y:0,width:120,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const be=p(me,[["render",pe]]),ve={name:"DecisionButton",props:{position:Object},components:{Decision:M},data(){return{}}};function we(e,t){const n=a("Decision"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{name:"Pdecision",x:20+80/2,y:8+40/2,width:35,height:35,fill:"white",stroke:"black",draggable:!0,text:"",scaleX:1,scaleY:1,hideEdit:!0,rotation:45}}),c(i,{config:{x:0,y:55,text:"Decision",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:120}}),c(o,{config:{name:"Pdecision",x:0,y:0,width:120,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const ye=p(ve,[["render",we]]),_e={name:"PrintButton",props:{position:Object},components:{Print:N},data(){return{}}};function ke(e,t){const n=a("Print"),i=a("v-text"),o=a("v-rect"),s=a("v-label");return r(),d(s,{config:{listening:!0,x:e.position.x,y:e.position.y}},{default:m(()=>[c(n,{config:{name:"Pprint",x:20+80/2,y:10+40/2,width:80,height:40,fill:"white",stroke:"black",draggable:!0,text:"",scaleX:1,scaleY:1,hideEdit:!0}}),c(i,{config:{x:0,y:55,text:"Imprimir",fontFamily:"Calibri",fontSize:18,padding:0,fill:"black",draggable:!1,align:"center",width:120}}),c(o,{config:{name:"Pprint",x:0,y:0,width:120,height:73,stroke:"black",strokeWidth:1}})]),_:1},8,["config"])}const Se=p(_e,[["render",ke]]),Te={name:"Panel",emits:["handlePanelMouseDown"],props:{panelSize:Object},data(){return{rectConfig:{x:-1,y:-1,width:this.panelSize.width,height:this.panelSize.height+2,fill:"#F9FFFF",stroke:"black",strokeWidth:1,listening:!1},xPadding:(this.panelSize.width-120)/3}},components:{StartButton:le,EndButton:he,ProcessButton:ue,DeclarationButton:be,DecisionButton:ye,PrintButton:Se},methods:{handlePanelMouseDown(e){this.$emit("handlePanelMouseDown",e)}},watch:{panelSize:{handler(e,t){this.rectConfig.width=e.width,this.rectConfig.height=e.height,this.xPadding=(e.width-120)/3},deep:!0}}};function Pe(e,t){const n=a("v-rect"),i=a("StartButton"),o=a("EndButton"),s=a("DeclarationButton"),l=a("ProcessButton"),f=a("DecisionButton"),u=a("PrintButton"),v=a("v-layer"),E=a("v-stage");return r(),d(E,{ref:"panel",config:e.panelSize,onMousedown:e.handlePanelMouseDown},{default:m(()=>[c(v,{ref:"layer",class:"layer"},{default:m(()=>[c(n,{config:e.rectConfig},null,8,["config"]),c(i,{position:{x:e.xPadding,y:30}},null,8,["position"]),c(o,{position:{x:e.xPadding+60+(e.panelSize.width-120-e.xPadding*2),y:30}},null,8,["position"]),c(s,{position:{x:e.xPadding,y:140}},null,8,["position"]),c(l,{position:{x:e.xPadding,y:240}},null,8,["position"]),c(f,{position:{x:e.xPadding,y:330}},null,8,["position"]),c(u,{position:{x:e.xPadding,y:430}},null,8,["position"])]),_:1},512)]),_:1},8,["config","onMousedown"])}const Ee=p(Te,[["render",Pe]]),Ce={name:"Grid",props:{space:Number,stageSize:Object},data(){return{}}};function De(e,t){const n=a("v-line");return r(),b(w,null,[(r(!0),b(w,null,y(Math.floor(e.stageSize.width/e.space),i=>(r(),d(n,{key:i,config:{x:i*e.space,y:0,points:[0,0,0,e.stageSize.height],stroke:"grey",strokeWidth:1,draggable:!1}},null,8,["config"]))),128)),(r(!0),b(w,null,y(Math.floor(e.stageSize.height/e.space),i=>(r(),d(n,{key:i,config:{x:0,y:i*e.space,points:[0,0,e.stageSize.width,0],stroke:"grey",strokeWidth:1,draggable:!1}},null,8,["config"]))),128))],64)}const ze=p(Ce,[["render",De]]);class Be{constructor(t,n,i,o){this.type=t,this.name=n,this.value=i,this.mutable=o}}class Me{constructor(t=null,n=null){this.type=t,this.variableName=n,this.description,this.setError=()=>{switch(this.type){case 0:this.type="Reference Error",this.description=`${this.type}: ${this.variableName} is not defined`;break;case 1:this.type="TypeError",this.description=`${this.type}: Assignment to constant variable`;break;case 2:this.type="SyntaxError",this.description=`${this.type}: Identifier '${this.variableName}' has already been declared`;break}},this.setError()}}class _{constructor(t,n,i=null){this.msg=t,this.error=n,this.typeError=i}}class Oe{constructor(){this.variables=[]}checkForRepetitions(t,n=!1){for(let i=0;i<this.variables.length;i++)if(this.variables[i].name===t){if(n)return new _(this.variables[i].value,!1);if(!n)return new _(this.variables[i].name,!0,2)}if(!n)return new _("Verigood",!1);if(n)return new _(t,!0,0)}checkForRepetitionsAfterDeclaration(t){for(let n=0;n<this.variables.length;n++)if(this.variables[n].name===t){if(!this.variables[n].mutable)return new _(t,!0,1);if(this.variables[n].mutable)return new _("Verigood",!1)}return new _(t,!0,0)}addNewVariable(t){this.checkForRepetitions(t).msg==="Verigood"&&this.variables.push(t)}getVariableValue(t){return this.checkForRepetitions(t,!0)}addNewVariableValue(t,n){for(let i=0;i<this.variables.length;i++)if(this.variables[i].name===t&&(this.variables[i].mutable&&(this.variables[i].value=n),!this.variables[i].mutable))return new _(t,!0,1)}getVariables(){return this.variables}resetVariables(){this.variables=[]}}const Ae=new RegExp(`^(var|let|const)\\s+([a-zA-Z]\\w*)\\s*=\\s(".*?"|\\'.*?\\'|[a-zA-Z]\\w*|\\d+(\\.\\d+)?|\\s*[+\\-*/]\\s*)+(?<!\\s*[+\\-*/]);`),Ne=new RegExp(`([a-zA-Z]\\w*)\\s*=\\s(".*?"|\\'.*?\\'|[a-zA-Z]\\w*|\\d+(\\.\\d+)?|\\s*[+\\-*/]\\s*)+(?<!\\s*[+\\-*/]);`),Fe=/^\s*if\s*\(\s*(["'].*["']|\d+|[a-zA-Z_$][0-9a-zA-Z_$]*)\s*((?:\s*(?:==|!=|<|>|<=|>=)\s*(["'].*["']|\d+|[a-zA-Z_$][0-9a-zA-Z_$]*))+)\s*\)\s*;/,Ve=/^(([a-zA-Z]+|\d+|\"[\w\s]+\")(\s*\+\s*([a-zA-Z]+|\d+|\"[\w\s]+\"))*);/,Xe=[/^\s*[+-]?(\d+|\d*\.\d+|\d+\.\d*)([Ee][+-]?\d+)?\s*$/,/".*?"|\'.*?\'|[a-zA-Z]\$/,/[+\-*/]/,/^(==|===|!=|!==|<|<=|>|>=|&&|\|\||!)$/],k=new Oe;class T{variableDeclaration(t){if(t=t.match(Ae),!t)return t;const[,n,i]=t;let o=k.checkForRepetitions(i);return o.error?this.setError(o):(o=this.doOperation(this.cleanPrompt(t.input)),o.error?this.setError(o):(k.addNewVariable(new Be(n,i,o,n!="const")),"Verigood"))}variableAsignation(t){if(t=t.match(Ne),!t)return t;let n=k.checkForRepetitionsAfterDeclaration(t[1]);return n.error?this.setError(n):(n=this.doOperation(this.cleanPrompt(t.input)),n.error?this.setError(n):(k.addNewVariableValue(t[1],n),"Verigood"))}conditionIF(t){if(t=t.match(Fe),!t)return t;t.input.slice(t.input.indexOf("(")+1,t.input.indexOf(")")).trim();const n=this.doOperation(this.cleanPrompt(t.input),"condition");return n.error?this.setError(n):n?"Verigood":"Notgood"}print(t){if(t=t.match(Ve),!t)return t;const n=this.doOperation(this.cleanPrompt(t.input,"printing"));return n.error?this.setError(n):(console.log("PRINTING -> "+n),n)}doOperation(t){let n="return",i;for(let o=0;o<t.length;o++)if(i=t[o],Object.keys(Xe.filter(s=>s.test(t[o]))).length==0){const s=k.getVariableValue(t[o]);if(s.error)return s;i=s.msg,typeof i=="string"?n+=` '${i}' `:n+=` ${i} `}else n+=` ${i} `;return new Function(n)()}setError(t){return new Me(t.typeError,t.msg)}cleanPrompt(t,n="variables"){const i=/".+?"/.exec(t);t=t.replace(/".+?"/,"").replace(/^\s+|\s+$/g,"");let s=t.slice(t.indexOf("(")+1,t.indexOf(")")).split(" ");if(n=="condition"){if(!i)return t.slice(t.indexOf("(")+1,t.indexOf(")"));if(i)return s[s.indexOf("")]=i[0],s}if(i&&n=="variables"&&(s.indexOf("")!=-1?s[s.indexOf("")]=i[0]:s.splice(s.indexOf(";"),0,i[0])),n=="printing")return i.index==0&&s.splice(0,0,i[0]),s.indexOf("")!=-1&&(s[s.indexOf("")]=i[0]),s;for(let l=0;l<s.length;l++)s[l]=s[l].replace(";",""),s[l]==""&&s.pop(l);return s.slice(s.indexOf("=")+1,s.length)}}k.resetVariables();class P{constructor(t,n){this.code=t,this.type=n}cleaningPrompt(t){return Object.values(t.split(/\r?\n/).map(n=>n.replace(/^\s+|\s+$/g,""))).filter(n=>n)}syntaxMethods(t){if(this.type==0)return new T().variableDeclaration(t);if(this.type==1)return new T().variableAsignation(t);if(this.type==2)return new T().conditionIF(t);if(this.type==3)return new T().print(t)}executeCode(){const t=this.cleaningPrompt(this.code);for(let n=0;n<t.length;n++)if(this.syntaxMethods(t[n])!=="Verigood")return"Notgood";return"Verigood"}printVariables(){console.log(k.getVariables())}}const Ye={name:"Header",emits:["toggleGrid","toggleLineTool","save","open","start"],props:{},data(){return{deg:0}},mounted(){this.deg=180},methods:{toggleGrid(e){this.$emit("toggleGrid",e)},toggleLineTool(e){this.$emit("toggleLineTool",e),this.deg+=180},save(e){this.$emit("save",e)},open(e){this.$emit("open",this.$refs.file.files[0])},start(e){this.$emit("start",e)}}},je="/assets/open-eaa73a9b.svg",xe="/assets/save-94c1eb15.svg",Ge="/assets/lineTool-b04e40ea.svg",We="/assets/play-4a96b981.svg",Ie="/assets/stop-f732a8dc.svg";const S=e=>(R("data-v-4492b41f"),e=e(),H(),e),Le=S(()=>g("div",{id:"Logo"},"VeriGood",-1)),Re={id:"Controls"},He={id:"Open"},Ze={for:"inputFile"},$e=S(()=>g("img",{src:je,alt:""},null,-1)),Je=S(()=>g("img",{src:xe,alt:""},null,-1)),qe=[Je],Ke=S(()=>g("img",{src:Ge,alt:""},null,-1)),Qe=[Ke],Ue={id:"Grid"},en={class:"switch"},nn=S(()=>g("div",{class:"slider round"},null,-1)),tn=S(()=>g("div",null,"Grid",-1)),sn={id:"Play"},on=S(()=>g("div",{id:"Stop"},[g("img",{src:Ie,alt:""})],-1));function an(e,t){return r(),b("header",null,[Le,g("div",Re,[g("div",He,[g("label",Ze,[g("input",{id:"inputFile",type:"file",ref:"file",onChange:t[0]||(t[0]=(...n)=>e.open&&e.open(...n))},null,544),$e])]),g("div",{id:"Save",onClick:t[1]||(t[1]=(...n)=>e.save&&e.save(...n))},qe),g("div",{id:"lineTool",class:"transition",style:L({transform:`rotate(${e.deg}deg)`}),onClick:t[2]||(t[2]=(...n)=>e.toggleLineTool&&e.toggleLineTool(...n))},Qe,4),g("div",Ue,[g("label",en,[g("input",{type:"checkbox",checked:"true",onClick:t[3]||(t[3]=(...n)=>e.toggleGrid&&e.toggleGrid(...n))}),nn]),tn]),g("div",sn,[g("img",{src:We,alt:"",onClick:t[4]||(t[4]=(...n)=>e.start&&e.start(...n))})]),on])])}const rn=p(Ye,[["render",an],["__scopeId","data-v-4492b41f"]]);const D=document.body.clientWidth,C=window.innerHeight-40+720,ln={data(){return{stageSize:{width:D*4/5,height:C},panelSize:{width:D*1/5,height:C},isDragging:!1,enabledAnchors:[],shapes:{starts:[],ends:[],declarations:[],processes:[],decisions:[],prints:[]},grid:!0,lines:[{points:[],color:"#"+Math.floor(Math.random()*16777215).toString(16),startShape:null,endShape:null,dash:[]}],startCounter:0,endCounter:0,processCounter:0,declarationCounter:0,decisionCounter:0,linesCounter:0,printCounter:0,lineTool:!1}},components:{Start:z,End:B,Decision:M,Process:A,Declaration:O,Print:N,Header:rn,Panel:Ee,Grid:ze},created(){window.addEventListener("resize",this.resizeScreen),setTimeout(()=>{this.resizeScreen()},500)},destroyed(){window.removeEventListener("resize",this.resizeScreen)},methods:{handleDragStart(e){this.isDragging=!0},async handleDragEnd(e){this.isDragging=!1;const t=this.selectedShapeName,n=await this.getShape(t);let i=e.target.attrs.x,o=e.target.attrs.y;n.x=i,n.y=o,setTimeout(()=>{n.x=Math.round(i/30)*30,n.y=Math.round(o/30)*30},100)},async handleTransformStart(e){const t=await this.getShape(this.selectedShapeName);t.hasOwnProperty("hideEdit")&&(t.hideEdit=!0)},async handleTransformEnd(e){const t=await this.getShape(this.selectedShapeName),n=e.target.getParent();t.x=n.x(),t.y=n.y(),t.rotation=n.rotation(),t.scaleX=e.target.scaleX(),t.scaleY=e.target.scaleY(),setTimeout(()=>{t.scaleX=1,t.scaleY=1,t.width=Math.max(t.width*e.target.scaleX(),5),t.height=Math.max(t.height*e.target.scaleY(),5),t.hasOwnProperty("hideEdit")&&(t.hideEdit=!1)},10)},async handleStageMouseDown(e){if(this.lineTool){let t=[...this.lines[this.linesCounter].points];const n=e.evt.layerX,i=e.evt.layerY,o=t[t.length-2],s=t[t.length-1];let l=Math.round(n/30)*30,f=Math.round(i/30)*30;if(o!=null&&s!=null)if(e.target===e.target.getStage())Math.abs(n-o)>Math.abs(i-s)?f=s:l=o;else{const u=e.target.name(),v=await this.getShape(u);f=v.y,l=v.x,t.push(l),t.push(f),this.lines[this.linesCounter].points=t,this.toggleLineTool(),this.toggleLineTool();return}else{const u=this.findNearestShape(l,f);this.lines[this.linesCounter].startShape=u.name,l=u.x,f=u.y,u.onTrue==!1&&u.onTrue!=null?u.onTrue=!0:u.onFalse!=null&&(u.onFalse=!0,this.lines[this.linesCounter].dash=[10])}t.push(l),t.push(f),this.lines[this.linesCounter].points=t;return}else{if(e.target===e.target.getStage()){this.selectedShapeName="",this.updateTransformer();return}if(e.target.getParent().className==="Transformer")return;const n=e.target.name();if(await this.getShape(n))switch(this.selectedShapeName=n,this.getSelectedShapeType(this.selectedShapeName)){case"starts":this.enabledAnchors=[];break;case"ends":this.enabledAnchors=[];break;case"declarations":this.enabledAnchors=["middle-right","bottom-center","bottom-right"];break;case"processes":this.enabledAnchors=["middle-right","bottom-center","bottom-right"];break;case"decisions":this.enabledAnchors=["middle-right","bottom-center","bottom-right"];break;case"prints":this.enabledAnchors=["middle-right","bottom-center","bottom-right"];break}else this.selectedShapeName="";this.updateTransformer()}},updateTransformer(){const e=this.$refs.transformer.getNode(),t=e.getStage(),{selectedShapeName:n}=this,i=t.findOne("."+n);i!==e.node()&&(i?e.nodes([i]):e.nodes([]))},getShape(e){let t;for(const n in this.shapes)if(t=this.shapes[n].find(i=>{if(i.name===e)return i}),t!=null)break;return t},getSelectedShapeType(e){let t,n;for(const i in this.shapes)if(t=this.shapes[i].find(o=>{if(o.name===e)return o}),t!=null){n=i;break}return n},findNearestShape(e,t){let n,i=1e5;for(const o in this.shapes)for(const s in this.shapes[o]){let l=this.shapes[o][s],f=Math.abs(e-l.x)+Math.abs(t-l.y);f<=i&&(i=f,n=l)}return n},async editProcess(e){const t=await this.getShape(e);t.text=await this.getNewText(t)},async getNewText(e){let t=await this.$swal({title:e.name,input:"textarea",inputValue:e.text,showCloseButton:!0});return console.log(t.value),t.value},handlePanelMouseDown(e){if(e.target===e.target.getStage())return;const t=e.target.name(),n=30,i=30;switch(t){case"Pstart":this.startCounter+=1;const o={name:"Pstart"+this.startCounter.toString(),x:n,y:i,radius:20,fill:"white",stroke:"black",strokeWidth:4,draggable:!0,isActive:!1};this.shapes.starts.push(o);break;case"Pend":this.endCounter+=1;const s={name:"Pend"+this.startCounter.toString(),x:n,y:i,radius:20,fill:"grey",stroke:"black",strokeWidth:4,draggable:!0,isActive:!1};this.shapes.ends.push(s);break;case"Pdeclaration":this.declarationCounter+=1;const l={name:"Pdeclaration"+this.declarationCounter.toString(),x:n,y:i,width:200,height:100,fill:"white",stroke:"black",draggable:!0,text:"...",scaleX:1,scaleY:1,hideEdit:!1,isActive:!1};this.shapes.declarations.push(l);break;case"Pprocess":this.processCounter+=1;const f={name:"Pprocess"+this.processCounter.toString(),x:n,y:i,width:200,height:100,fill:"white",stroke:"black",draggable:!0,text:"...",scaleX:1,scaleY:1,hideEdit:!1,isActive:!1};this.shapes.processes.push(f);break;case"Pdecision":this.decisionCounter+=1;const u={name:"Pdecision"+this.decisionCounter.toString(),x:n,y:i,width:100,height:100,fill:"white",stroke:"black",draggable:!0,text:"...",scaleX:1,scaleY:1,rotation:45,isActive:!1,onTrue:!1,onFalse:!1};this.shapes.decisions.push(u);break;case"Pprint":this.printCounter+=1;const v={name:"Pprint"+this.printCounter.toString(),x:n,y:i,width:200,height:100,fill:"white",stroke:"black",draggable:!0,text:"...",scaleX:1,scaleY:1,hideEdit:!1,isActive:!1};this.shapes.prints.push(v);break}},toggleGrid(e){this.grid=!this.grid},resizeScreen(e){const t={width:document.body.clientWidth*4/5,height:C};this.stageSize=t;const n={width:document.body.clientWidth*1/5,height:window.innerHeight-40};this.panelSize=n},toggleLineTool(e){if(this.lineTool=!this.lineTool,!this.lineTool&&this.lines[this.linesCounter].points.length>0){const t=this.lines[this.linesCounter].points.length;let n=this.findNearestShape(this.lines[this.linesCounter].points[t-2],this.lines[this.linesCounter].points[t-1]);this.lines[this.linesCounter].points.push(n.x),this.lines[this.linesCounter].points.push(this.lines[this.linesCounter].points[t-1]),this.lines[this.linesCounter].points.push(this.lines[this.linesCounter].points[t]),this.lines[this.linesCounter].points.push(n.y),this.lines[this.linesCounter].endShape=n.name,this.lines[this.linesCounter].points=this.cleanPoints(this.lines[this.linesCounter].points),this.linesCounter+=1;const i="#"+Math.floor(Math.random()*11184810+11184810).toString(16);this.lines.push({points:[],color:i,dash:[]})}},cleanPoints(e){let t=e[0],n=e[1],i=e[2],o=e[3];for(let s=4;s<e.length;s+=2)i==t&&t==e[s]?(delete e[s-2],delete e[s-1],i=e[s]):(t=i,i=e[s]),o==n&&n==e[s+1]?(delete e[s-2],delete e[s-1],o=e[s+1]):(n=o,o=e[s+1]);return e=e.filter(s=>s!==null),e},save(e){let t={shapes:this.shapes,lines:this.lines,startCounter:this.startCounter,endCounter:this.endCounter,processCounter:this.processCounter,linesCounter:this.linesCounter,decisionCounter:this.decisionCounter},n=JSON.stringify(t);var i=new Blob([n],{type:"text/plain;charset=utf-8"});saveAs(i,"download.json")},open(e){const t=new FileReader;t.onload=n=>{const i=JSON.parse(n.target.result);this.shapes=i.shapes,this.lines=i.lines,this.startCounter=i.startCounter,this.endCounter=i.endCounter,this.processCounter=i.processCounter,this.linesCounter=i.linesCounter,this.decisionCounter=i.decisionCounter},t.onerror=n=>console.error(n),t.readAsText(e)},findNext(e,t=!0){for(let n in this.lines)if(this.lines[n].startShape==e){if(t)return this.lines[n].endShape;t=!0}return"Pend1"},async build(){console.info("build");let e="Pstart1",t=["Pstart1"],n="Verigood";for(;e!="Pend1";){n="Verigood";let i=await this.getShape(e);i.isActive=!0;let o=!0;if(i.text!=null)switch(this.getSelectedShapeType(i.name)){case"declarations":n=new P(i.text,0).executeCode();break;case"processes":n=new P(i.text,1).executeCode();break;case"prints":n=new P(i.text,3).executeCode();break;case"decisions":n=new P(i.text,2).executeCode()=="Verigood",o=n;break}if(await this.timeout(1e3),i.isActive=!1,n==null)break;e=this.findNext(e,o),t.push(e)}return t},run(e){this.build()},timeout(e){return new Promise(t=>setTimeout(t,e))}}},cn={id:"container"},dn={id:"Panel"},hn={id:"Canva"};function gn(e,t,n,i,o,s){const l=a("Header"),f=a("Panel"),u=a("Grid"),v=a("v-line"),E=a("Start"),F=a("End"),V=a("Declaration"),X=a("Process"),Y=a("Print"),j=a("Decision"),x=a("v-transformer"),G=a("v-layer"),W=a("v-stage");return r(),b(w,null,[c(l,{onToggleGrid:s.toggleGrid,onToggleLineTool:s.toggleLineTool,onSave:s.save,onOpen:s.open,onStart:s.run},null,8,["onToggleGrid","onToggleLineTool","onSave","onOpen","onStart"]),g("div",cn,[g("div",dn,[c(f,{panelSize:o.panelSize,onHandlePanelMouseDown:s.handlePanelMouseDown},null,8,["panelSize","onHandlePanelMouseDown"])]),g("div",hn,[c(W,{ref:"stage",config:o.stageSize,onMousedown:s.handleStageMouseDown,onTouchstart:s.handleStageMouseDown},{default:m(()=>[c(G,{ref:"layer",class:"layer"},{default:m(()=>[o.grid?(r(),d(u,{key:0,space:30,stageSize:o.stageSize},null,8,["stageSize"])):Z("",!0),(r(!0),b(w,null,y(o.lines,h=>(r(),d(v,{key:h,config:{x:0,y:0,points:h.points,stroke:h.color,strokeWidth:5,draggable:!1,dash:h.dash}},null,8,["config"]))),128)),(r(!0),b(w,null,y(o.shapes.starts,h=>(r(),d(E,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onDragstart:s.handleDragStart,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onDragstart","onDragend"]))),128)),(r(!0),b(w,null,y(o.shapes.ends,h=>(r(),d(F,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onDragstart:s.handleDragStart,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onDragstart","onDragend"]))),128)),(r(!0),b(w,null,y(o.shapes.declarations,h=>(r(),d(V,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onTransformstart:s.handleTransformStart,onEditProcess:s.editProcess,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onTransformstart","onEditProcess","onDragend"]))),128)),(r(!0),b(w,null,y(o.shapes.processes,h=>(r(),d(X,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onTransformstart:s.handleTransformStart,onEditProcess:s.editProcess,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onTransformstart","onEditProcess","onDragend"]))),128)),(r(!0),b(w,null,y(o.shapes.prints,h=>(r(),d(Y,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onTransformstart:s.handleTransformStart,onEditProcess:s.editProcess,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onTransformstart","onEditProcess","onDragend"]))),128)),(r(!0),b(w,null,y(o.shapes.decisions,h=>(r(),d(j,{key:h.id,config:h,highlight:h.isActive,onTransformend:s.handleTransformEnd,onTransformstart:s.handleTransformStart,onEditProcess:s.editProcess,onDragend:s.handleDragEnd},null,8,["config","highlight","onTransformend","onTransformstart","onEditProcess","onDragend"]))),128)),c(x,{ref:"transformer",rotateEnabled:!1,flipEnabled:!1,ignoreStroke:!0,enabledAnchors:o.enabledAnchors},null,8,["enabledAnchors"])]),_:1},512)]),_:1},8,["config","onMousedown","onTouchstart"])])])],64)}const un=p(ln,[["render",gn],["__scopeId","data-v-75e3598c"]]);export{un as default};
